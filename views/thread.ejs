<!-- thread.ejs -->
<!DOCTYPE html>
<html>
  <head>
    <title><%= thread.title %></title>
  </head>
  <body>
    <%- include('partials/navbar') %>
    <h1><%= thread.title %></h1>
    <a href="/forum">Back to forum</a>
    <hr>
    <div>
      <h3>By <%= thread.author.displayName %> at <%= thread.createdAt %></h3>
      <p><%= thread.content %></p>
    </div>
    <% thread.Posts.forEach(post => { %>
      <div>
        <p>By <%= post.author.displayName %> at <%= post.createdAt %></p>
        <% if (post.ReplyTo) { %>
          <p><strong>Replying to:</strong> <%= post.author.displayName %> : <%= post.ReplyToPost.content.substring(0, 20) %>...</p>
        <% } %>
        <p><%= post.content %></p>
        <% if (post.author.spotifyId === user.spotifyId) { %>
          <a href="/forum/post/<%= post.id %>/edit">Edit</a>
          <form action="/forum/post/<%= post.id %>/delete" method="post" style="display:inline;">
            <button type="submit">Delete</button>
          </form>
        <% } %>
        <a href="/forum/thread/<%= thread.id %>/reply-to/<%= post.id %>">Reply</a> 
      </div>
    <% }); %>
    <hr>
    <form action="/forum/thread/<%= thread.id %>/new-post" method="post">
      <label for="content">New Post:</label>
      <textarea name="content" id="content" required></textarea>
      <br>
      <button type="submit">Post</button>
    </form>
  </body>
</html>

   
